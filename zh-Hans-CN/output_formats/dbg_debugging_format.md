6.10 `dbg`: 调试格式.
======

在缺省配置下，`dbg`输出格式不会被构建进 NASM 中.如果你是从源代码开始构建你自己的 NASM 可执行版本，你可以在`outform.h`中定义`OF_DBG`或在编译器的命令行上定义，这样就可以得到`dbg`输出格式.`dbg`格式不输出一个普通的目标文件;

它输出一个文本文件，包含有一个关于到输出格式的最终模块的转化动作的列表.它主要是用于帮助那些希望写自己的驱动程序的用户，这样他们就可以得到一个关于主程序的各种请求在输出中的形式的完整印象.对于简单的文件，可以简单地象下面这样使用:

```shell
$ nasm -f dbg filename.asm
```

这会产生一个叫做`filename.dgb`的诊断文件.但是，这在另一些目标文件上可能工作得并不是很好，因为每一个目标文件定义了它自己的宏(通常是用户级形式的操作符)，而这些宏在`dbg`格式中并没有定义.因此，运行 NASM 两遍是非常有用的，这是为了对选定的源目标文件作一个预处理:

```shell
$ nasm -e -f rdf -o rdfprog.i rdfprog.asm 
$ nasm -a -f dbg rdfprog.i
```

这先把`rdfprog.asm` 先预处理成`rdfprog.i`，让 RDF 特定的操作符被正确的转化成原始形式.然后，被预处理过的源程序被交给`dbg`格式去产生最终的诊断输出.这种方式对于`obj`格式还是不能正确工作的，因为`obj`的`SEGMENT`和`GROUP`操作符在把段名与组名定义为符号的时候会有副作用;

所以程序不会被汇编.如果你确实需要 trace 一个 obj 的源文件，你必须自己定义符号(比如使用`EXTERN`)`dbg`接受所有的段名与操作符，并把它们全部记录在自己的输出文件中.
