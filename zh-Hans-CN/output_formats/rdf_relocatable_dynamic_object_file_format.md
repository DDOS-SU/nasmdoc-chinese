6.9 `rdf`: 可重定位的动态目标文件格式.
======

`rdf`输出格式产生`RDOFF`目标文件.`RDOFF`(可重定位的动态目标文件格式)`RDOFF`是 NASM 自产的目标文件格式，是 NASM 自已设计的，它被反映在汇编器的内部结构中.`RDOFF`在所有知名的操作系统中都没有得到应用.但是，那些正在写他们自己的操作系统的人可能非常希望使用`RDOFF`作为他们自己的目标文件格式，因为`RDOFF`被设计得非常简单，并含有很少的冗余文件头信息.NASM 的含有源代码的 Unix 包和 DOS 包中都含有一个`rdoff`子目录，里面有一套RDOFF 工具:一个 RDF 连接器，一个 RDF 静态库管理器，一个 RDF 文件 dump 工具，还有一个程序可以用来在 Linux 下载入和执行 RDF 程序.`rdf`只支持标准的段名`.text`，`.data`，`.bss`.

## 6.9.1 需要一个库: `LIBRARY`操作符

`RDOFF`拥有一种机制，让一个目标文件请求一个指定的库被连接进模块中，可以是在载入时，也可以是在运行时连接进来.这是通过`LIBRARY`操作符完成的，它带有一个参数，即这个库的名字:

```nasm
           library  mylib.rdl
```

## 6.9.2 指定一个模块名称: `MODULE`操作符.

特定的`RDOFF`头记录被用来存储模块的名字.它可以被用在运行时载入器作动态连接.`MODULE`操作符带有一个参数，即当前模块的名字:

```nasm
           module  mymodname
```

注意，当你静态连接一个模块，并告诉连接器从输出文件中除去符号时，所有的模块名字也会被除去.为了避免这种情况，你应当在模块的名字前加一个`$`，就像:

```nasm
           module  $kernel.core
```

## 6.9.3 `rdf`对`GLOBAL`操作符的扩展.

`RDOFF`全局符号可以包含静态连接器需要的额外信息.你可以把一个全局符号标识为导出的，这就告诉连接器不要把它从目标可执行文件中或库文件中除去.就象在`ELF`中一样，你也可以指定一个导出符号是一个过程或是一个数据对象.在名字的尾部加上一个冒号和`exporg`，你就可以让一个符号被导出:

```nasm
           global  sys_open:export
```

要指定一个导出符号是一个过程(函数)，你要在声明的后南加上`proc`或`function`

```nasm
           global  sys_open:export proc
```

相似的，要指定一个导出的数据对象，把`data`或`object`加到操作符的后面:

```nasm
           global  kernel_ticks:export data
```
